var St=e=>{throw TypeError(e)};var nt=(e,t,s)=>t.has(e)||St("Cannot "+s);var r=(e,t,s)=>(nt(e,t,"read from private field"),s?s.call(e):t.get(e)),d=(e,t,s)=>t.has(e)?St("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,s),o=(e,t,s,i)=>(nt(e,t,"write to private field"),i?i.call(e,s):t.set(e,s),s),f=(e,t,s)=>(nt(e,t,"access private method"),s);import{r as C,a as Kt}from"./chunk-QMGIS6GS-CAbI30z5.js";import{S as Pt,p as Et,r as T,s as Y,a as V,n as tt,i as ht,b as Ot,t as Bt,f as Nt,c as qt,d as wt,e as st,h as Tt,g as Ht,j as xt,u as pt}from"./QueryClientProvider-CFXmjb4k.js";import"./jsx-runtime-D_zvdyIk.js";import{h as Ft,a as Lt}from"./PasswordInput-nlRO0sH5.js";import{u as _t}from"./useTranslation-CB6DjjYO.js";var v,u,W,p,x,j,D,A,$,k,K,F,L,M,B,c,z,ut,ct,ot,lt,ft,dt,yt,jt,Mt,zt=(Mt=class extends Pt{constructor(t,s){super();d(this,c);d(this,v);d(this,u);d(this,W);d(this,p);d(this,x);d(this,j);d(this,D);d(this,A);d(this,$);d(this,k);d(this,K);d(this,F);d(this,L);d(this,M);d(this,B,new Set);this.options=s,o(this,v,t),o(this,A,null),o(this,D,Et()),this.options.experimental_prefetchInRender||r(this,D).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(s)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(r(this,u).addObserver(this),It(r(this,u),this.options)?f(this,c,z).call(this):this.updateResult(),f(this,c,lt).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return bt(r(this,u),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return bt(r(this,u),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,f(this,c,ft).call(this),f(this,c,dt).call(this),r(this,u).removeObserver(this)}setOptions(t){const s=this.options,i=r(this,u);if(this.options=r(this,v).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof T(this.options.enabled,r(this,u))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");f(this,c,yt).call(this),r(this,u).setOptions(this.options),s._defaulted&&!Y(this.options,s)&&r(this,v).getQueryCache().notify({type:"observerOptionsUpdated",query:r(this,u),observer:this});const n=this.hasListeners();n&&Qt(r(this,u),i,this.options,s)&&f(this,c,z).call(this),this.updateResult(),n&&(r(this,u)!==i||T(this.options.enabled,r(this,u))!==T(s.enabled,r(this,u))||V(this.options.staleTime,r(this,u))!==V(s.staleTime,r(this,u)))&&f(this,c,ut).call(this);const h=f(this,c,ct).call(this);n&&(r(this,u)!==i||T(this.options.enabled,r(this,u))!==T(s.enabled,r(this,u))||h!==r(this,M))&&f(this,c,ot).call(this,h)}getOptimisticResult(t){const s=r(this,v).getQueryCache().build(r(this,v),t),i=this.createResult(s,t);return Wt(this,i)&&(o(this,p,i),o(this,j,this.options),o(this,x,r(this,u).state)),i}getCurrentResult(){return r(this,p)}trackResult(t,s){return new Proxy(t,{get:(i,n)=>(this.trackProp(n),s==null||s(n),Reflect.get(i,n))})}trackProp(t){r(this,B).add(t)}getCurrentQuery(){return r(this,u)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const s=r(this,v).defaultQueryOptions(t),i=r(this,v).getQueryCache().build(r(this,v),s);return i.fetch().then(()=>this.createResult(i,s))}fetch(t){return f(this,c,z).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),r(this,p)))}createResult(t,s){var Ct;const i=r(this,u),n=this.options,h=r(this,p),a=r(this,x),y=r(this,j),g=t!==i?t.state:r(this,W),{state:E}=t;let l={...E},N=!1,m;if(s._optimisticResults){const O=this.hasListeners(),J=!O&&It(t,s),_=O&&Qt(t,i,s,n);(J||_)&&(l={...l,...qt(E.data,t.options)}),s._optimisticResults==="isRestoring"&&(l.fetchStatus="idle")}let{error:q,errorUpdatedAt:H,status:S}=l;m=l.data;let Z=!1;if(s.placeholderData!==void 0&&m===void 0&&S==="pending"){let O;h!=null&&h.isPlaceholderData&&s.placeholderData===(y==null?void 0:y.placeholderData)?(O=h.data,Z=!0):O=typeof s.placeholderData=="function"?s.placeholderData((Ct=r(this,K))==null?void 0:Ct.state.data,r(this,K)):s.placeholderData,O!==void 0&&(S="success",m=wt(h==null?void 0:h.data,O,s),N=!0)}if(s.select&&m!==void 0&&!Z)if(h&&m===(a==null?void 0:a.data)&&s.select===r(this,$))m=r(this,k);else try{o(this,$,s.select),m=s.select(m),m=wt(h==null?void 0:h.data,m,s),o(this,k,m),o(this,A,null)}catch(O){o(this,A,O)}r(this,A)&&(q=r(this,A),m=r(this,k),H=Date.now(),S="error");const rt=l.fetchStatus==="fetching",it=S==="pending",at=S==="error",vt=it&&rt,Rt=m!==void 0,w={status:S,fetchStatus:l.fetchStatus,isPending:it,isSuccess:S==="success",isError:at,isInitialLoading:vt,isLoading:vt,data:m,dataUpdatedAt:l.dataUpdatedAt,error:q,errorUpdatedAt:H,failureCount:l.fetchFailureCount,failureReason:l.fetchFailureReason,errorUpdateCount:l.errorUpdateCount,isFetched:l.dataUpdateCount>0||l.errorUpdateCount>0,isFetchedAfterMount:l.dataUpdateCount>g.dataUpdateCount||l.errorUpdateCount>g.errorUpdateCount,isFetching:rt,isRefetching:rt&&!it,isLoadingError:at&&!Rt,isPaused:l.fetchStatus==="paused",isPlaceholderData:N,isRefetchError:at&&Rt,isStale:gt(t,s),refetch:this.refetch,promise:r(this,D)};if(this.options.experimental_prefetchInRender){const O=G=>{w.status==="error"?G.reject(w.error):w.data!==void 0&&G.resolve(w.data)},J=()=>{const G=o(this,D,w.promise=Et());O(G)},_=r(this,D);switch(_.status){case"pending":t.queryHash===i.queryHash&&O(_);break;case"fulfilled":(w.status==="error"||w.data!==_.value)&&J();break;case"rejected":(w.status!=="error"||w.error!==_.reason)&&J();break}}return w}updateResult(){const t=r(this,p),s=this.createResult(r(this,u),this.options);if(o(this,x,r(this,u).state),o(this,j,this.options),r(this,x).data!==void 0&&o(this,K,r(this,u)),Y(s,t))return;o(this,p,s);const i=()=>{if(!t)return!0;const{notifyOnChangeProps:n}=this.options,h=typeof n=="function"?n():n;if(h==="all"||!h&&!r(this,B).size)return!0;const a=new Set(h??r(this,B));return this.options.throwOnError&&a.add("error"),Object.keys(r(this,p)).some(y=>{const b=y;return r(this,p)[b]!==t[b]&&a.has(b)})};f(this,c,jt).call(this,{listeners:i()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&f(this,c,lt).call(this)}},v=new WeakMap,u=new WeakMap,W=new WeakMap,p=new WeakMap,x=new WeakMap,j=new WeakMap,D=new WeakMap,A=new WeakMap,$=new WeakMap,k=new WeakMap,K=new WeakMap,F=new WeakMap,L=new WeakMap,M=new WeakMap,B=new WeakMap,c=new WeakSet,z=function(t){f(this,c,yt).call(this);let s=r(this,u).fetch(this.options,t);return t!=null&&t.throwOnError||(s=s.catch(tt)),s},ut=function(){f(this,c,ft).call(this);const t=V(this.options.staleTime,r(this,u));if(ht||r(this,p).isStale||!Ot(t))return;const i=Bt(r(this,p).dataUpdatedAt,t)+1;o(this,F,setTimeout(()=>{r(this,p).isStale||this.updateResult()},i))},ct=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(r(this,u)):this.options.refetchInterval)??!1},ot=function(t){f(this,c,dt).call(this),o(this,M,t),!(ht||T(this.options.enabled,r(this,u))===!1||!Ot(r(this,M))||r(this,M)===0)&&o(this,L,setInterval(()=>{(this.options.refetchIntervalInBackground||Nt.isFocused())&&f(this,c,z).call(this)},r(this,M)))},lt=function(){f(this,c,ut).call(this),f(this,c,ot).call(this,f(this,c,ct).call(this))},ft=function(){r(this,F)&&(clearTimeout(r(this,F)),o(this,F,void 0))},dt=function(){r(this,L)&&(clearInterval(r(this,L)),o(this,L,void 0))},yt=function(){const t=r(this,v).getQueryCache().build(r(this,v),this.options);if(t===r(this,u))return;const s=r(this,u);o(this,u,t),o(this,W,t.state),this.hasListeners()&&(s==null||s.removeObserver(this),t.addObserver(this))},jt=function(t){st.batch(()=>{t.listeners&&this.listeners.forEach(s=>{s(r(this,p))}),r(this,v).getQueryCache().notify({query:r(this,u),type:"observerResultsUpdated"})})},Mt);function Vt(e,t){return T(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function It(e,t){return Vt(e,t)||e.state.data!==void 0&&bt(e,t,t.refetchOnMount)}function bt(e,t,s){if(T(t.enabled,e)!==!1&&V(t.staleTime,e)!=="static"){const i=typeof s=="function"?s(e):s;return i==="always"||i!==!1&&gt(e,t)}return!1}function Qt(e,t,s,i){return(e!==t||T(i.enabled,e)===!1)&&(!s.suspense||e.state.status!=="error")&&gt(e,s)}function gt(e,t){return T(t.enabled,e)!==!1&&e.isStaleByTime(V(t.staleTime,e))}function Wt(e,t){return!Y(e.getCurrentResult(),t)}var U,P,R,I,Q,X,mt,Ut,$t=(Ut=class extends Pt{constructor(t,s){super();d(this,Q);d(this,U);d(this,P);d(this,R);d(this,I);o(this,U,t),this.setOptions(s),this.bindMethods(),f(this,Q,X).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){var i;const s=this.options;this.options=r(this,U).defaultMutationOptions(t),Y(this.options,s)||r(this,U).getMutationCache().notify({type:"observerOptionsUpdated",mutation:r(this,R),observer:this}),s!=null&&s.mutationKey&&this.options.mutationKey&&Tt(s.mutationKey)!==Tt(this.options.mutationKey)?this.reset():((i=r(this,R))==null?void 0:i.state.status)==="pending"&&r(this,R).setOptions(this.options)}onUnsubscribe(){var t;this.hasListeners()||(t=r(this,R))==null||t.removeObserver(this)}onMutationUpdate(t){f(this,Q,X).call(this),f(this,Q,mt).call(this,t)}getCurrentResult(){return r(this,P)}reset(){var t;(t=r(this,R))==null||t.removeObserver(this),o(this,R,void 0),f(this,Q,X).call(this),f(this,Q,mt).call(this)}mutate(t,s){var i;return o(this,I,s),(i=r(this,R))==null||i.removeObserver(this),o(this,R,r(this,U).getMutationCache().build(r(this,U),this.options)),r(this,R).addObserver(this),r(this,R).execute(t)}},U=new WeakMap,P=new WeakMap,R=new WeakMap,I=new WeakMap,Q=new WeakSet,X=function(){var s;const t=((s=r(this,R))==null?void 0:s.state)??Ht();o(this,P,{...t,isPending:t.status==="pending",isSuccess:t.status==="success",isError:t.status==="error",isIdle:t.status==="idle",mutate:this.mutate,reset:this.reset})},mt=function(t){st.batch(()=>{var s,i,n,h,a,y,b,g;if(r(this,I)&&this.hasListeners()){const E=r(this,P).variables,l=r(this,P).context;(t==null?void 0:t.type)==="success"?((i=(s=r(this,I)).onSuccess)==null||i.call(s,t.data,E,l),(h=(n=r(this,I)).onSettled)==null||h.call(n,t.data,null,E,l)):(t==null?void 0:t.type)==="error"&&((y=(a=r(this,I)).onError)==null||y.call(a,t.error,E,l),(g=(b=r(this,I)).onSettled)==null||g.call(b,void 0,t.error,E,l))}this.listeners.forEach(E=>{E(r(this,P))})})},Ut),kt=C.createContext(!1),Zt=()=>C.useContext(kt);kt.Provider;function Jt(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var Gt=C.createContext(Jt()),Xt=()=>C.useContext(Gt),Yt=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},te=e=>{C.useEffect(()=>{e.clearReset()},[e])},ee=({result:e,errorResetBoundary:t,throwOnError:s,query:i,suspense:n})=>e.isError&&!t.isReset()&&!e.isFetching&&i&&(n&&e.data===void 0||xt(s,[e.error,i])),se=e=>{if(e.suspense){const t=i=>i==="static"?i:Math.max(i??1e3,1e3),s=e.staleTime;e.staleTime=typeof s=="function"?(...i)=>t(s(...i)):t(s),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},re=(e,t)=>e.isLoading&&e.isFetching&&!t,ie=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,Dt=(e,t,s)=>t.fetchOptimistic(e).catch(()=>{s.clearReset()});function ae(e,t,s){var l,N,m,q,H;const i=Zt(),n=Xt(),h=pt(),a=h.defaultQueryOptions(e);(N=(l=h.getDefaultOptions().queries)==null?void 0:l._experimental_beforeQuery)==null||N.call(l,a),a._optimisticResults=i?"isRestoring":"optimistic",se(a),Yt(a,n),te(n);const y=!h.getQueryCache().get(a.queryHash),[b]=C.useState(()=>new t(h,a)),g=b.getOptimisticResult(a),E=!i&&e.subscribed!==!1;if(C.useSyncExternalStore(C.useCallback(S=>{const Z=E?b.subscribe(st.batchCalls(S)):tt;return b.updateResult(),Z},[b,E]),()=>b.getCurrentResult(),()=>b.getCurrentResult()),C.useEffect(()=>{b.setOptions(a)},[a,b]),ie(a,g))throw Dt(a,b,n);if(ee({result:g,errorResetBoundary:n,throwOnError:a.throwOnError,query:h.getQueryCache().get(a.queryHash),suspense:a.suspense}))throw g.error;if((q=(m=h.getDefaultOptions().queries)==null?void 0:m._experimental_afterQuery)==null||q.call(m,a,g),a.experimental_prefetchInRender&&!ht&&re(g,i)){const S=y?Dt(a,b,n):(H=h.getQueryCache().get(a.queryHash))==null?void 0:H.promise;S==null||S.catch(tt).finally(()=>{b.updateResult()})}return a.notifyOnChangeProps?g:b.trackResult(g)}function ne(e,t){return ae(e,zt)}function he(e,t){const s=pt(),[i]=C.useState(()=>new $t(s,e));C.useEffect(()=>{i.setOptions(e)},[i,e]);const n=C.useSyncExternalStore(C.useCallback(a=>i.subscribe(st.batchCalls(a)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),h=C.useCallback((a,y)=>{i.mutate(a,y).catch(tt)},[i]);if(n.error&&xt(i.options.throwOnError,[n.error]))throw n.error;return{...n,mutate:h,mutateAsync:n.mutate}}const ge={USERS:{LIST:"/users",CREATE:"/users",DETAIL:e=>`/users/${e}`,UPDATE:e=>`/users/${e}`,DELETE:e=>`/users/${e}`}},ue=e=>e.replace(/_([a-zA-Z0-9])/g,(t,s)=>/[a-zA-Z]/.test(s)?s.toUpperCase():s),et=(e,t)=>{const s={};for(const[i,n]of Object.entries(t)){const h=ce(e,i);if(h!=null)if(Array.isArray(n)&&Array.isArray(h)){const a=n[0];s[i]=h.map(y=>typeof a=="object"&&a!==null?et(y,a):At(y,a))}else typeof n=="object"&&n!==null&&!Array.isArray(n)?s[i]=et(h,n):s[i]=At(h,n)}return s},ce=(e,t)=>{const s=Object.keys(e).find(i=>ue(i)===t);if(s)return e[s]},At=(e,t)=>t===Date?(e instanceof Date?e:new Date(e)).toISOString():t===Number?Number(e):t===Boolean?!!e:t===String?typeof e=="string"||e===null||e===void 0?e:typeof e=="object"?JSON.stringify(e):String(e):e;function oe(){const e=pt();return{call:s=>{s&&s.forEach(i=>{e.removeQueries({queryKey:Array.isArray(i)?i:[i]})})}}}function ve(e,t){e.data&&(t!=null&&t.bodyParamsStruct)?e.data=et(e.data,t.bodyParamsStruct):e.data={};const{t:s}=_t("common");return{query:ne({queryKey:(t==null?void 0:t.querykey)??[],queryFn:async()=>{try{return(await Lt(e)).data}catch(n){const h=Ft(n,{t:s,message:t==null?void 0:t.message});if(h)throw new Error(h);return null}}})}}function Re(e,t){const{t:s}=_t("common"),i=Kt(),n=oe();return{mutation:he({mutationFn:(a,y)=>(a&&(t!=null&&t.bodyParamsStruct)?e.data=et(a,t.bodyParamsStruct):e.data={},y&&(e={...e,...y}),Lt(e)),onError:a=>{Ft(a,{t:s,message:t==null?void 0:t.message})},onSuccess(a){var y;(y=t==null?void 0:t.onSuccess)==null||y.call(t,a.data),n.call(t==null?void 0:t.refreshQuerykey),t!=null&&t.redirect&&i(t.redirect)}})}}export{ge as A,ve as a,oe as b,Re as u};
