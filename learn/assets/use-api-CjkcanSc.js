var St=e=>{throw TypeError(e)};var nt=(e,t,s)=>t.has(e)||St("Cannot "+s);var r=(e,t,s)=>(nt(e,t,"read from private field"),s?s.call(e):t.get(e)),d=(e,t,s)=>t.has(e)?St("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,s),c=(e,t,s,i)=>(nt(e,t,"write to private field"),i?i.call(e,s):t.set(e,s),s),f=(e,t,s)=>(nt(e,t,"access private method"),s);import{r as C,a as Kt}from"./chunk-QMGIS6GS-CdgJu9QH.js";import{S as xt,k as Et,l as T,q as Y,r as V,b as tt,t as ht,u as Ot,v as Bt,f as qt,w as Nt,x as wt,n as st,i as Tt,y as zt,z as Pt,A as pt}from"./QueryClientProvider-CS_NyGzZ.js";import"./jsx-runtime-D_zvdyIk.js";import{h as Ft,a as Lt}from"./label-DENv6mB2.js";import{u as _t}from"./useTranslation-CZ11WS3S.js";var v,u,W,p,P,j,D,A,$,k,K,F,L,M,B,o,H,ut,ot,ct,lt,ft,dt,yt,jt,Mt,Ht=(Mt=class extends xt{constructor(t,s){super();d(this,o);d(this,v);d(this,u);d(this,W);d(this,p);d(this,P);d(this,j);d(this,D);d(this,A);d(this,$);d(this,k);d(this,K);d(this,F);d(this,L);d(this,M);d(this,B,new Set);this.options=s,c(this,v,t),c(this,A,null),c(this,D,Et()),this.options.experimental_prefetchInRender||r(this,D).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(s)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(r(this,u).addObserver(this),It(r(this,u),this.options)?f(this,o,H).call(this):this.updateResult(),f(this,o,lt).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return bt(r(this,u),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return bt(r(this,u),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,f(this,o,ft).call(this),f(this,o,dt).call(this),r(this,u).removeObserver(this)}setOptions(t){const s=this.options,i=r(this,u);if(this.options=r(this,v).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof T(this.options.enabled,r(this,u))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");f(this,o,yt).call(this),r(this,u).setOptions(this.options),s._defaulted&&!Y(this.options,s)&&r(this,v).getQueryCache().notify({type:"observerOptionsUpdated",query:r(this,u),observer:this});const a=this.hasListeners();a&&Qt(r(this,u),i,this.options,s)&&f(this,o,H).call(this),this.updateResult(),a&&(r(this,u)!==i||T(this.options.enabled,r(this,u))!==T(s.enabled,r(this,u))||V(this.options.staleTime,r(this,u))!==V(s.staleTime,r(this,u)))&&f(this,o,ut).call(this);const h=f(this,o,ot).call(this);a&&(r(this,u)!==i||T(this.options.enabled,r(this,u))!==T(s.enabled,r(this,u))||h!==r(this,M))&&f(this,o,ct).call(this,h)}getOptimisticResult(t){const s=r(this,v).getQueryCache().build(r(this,v),t),i=this.createResult(s,t);return Wt(this,i)&&(c(this,p,i),c(this,j,this.options),c(this,P,r(this,u).state)),i}getCurrentResult(){return r(this,p)}trackResult(t,s){return new Proxy(t,{get:(i,a)=>(this.trackProp(a),s==null||s(a),Reflect.get(i,a))})}trackProp(t){r(this,B).add(t)}getCurrentQuery(){return r(this,u)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const s=r(this,v).defaultQueryOptions(t),i=r(this,v).getQueryCache().build(r(this,v),s);return i.fetch().then(()=>this.createResult(i,s))}fetch(t){return f(this,o,H).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),r(this,p)))}createResult(t,s){var Ct;const i=r(this,u),a=this.options,h=r(this,p),n=r(this,P),y=r(this,j),g=t!==i?t.state:r(this,W),{state:E}=t;let l={...E},q=!1,m;if(s._optimisticResults){const O=this.hasListeners(),J=!O&&It(t,s),_=O&&Qt(t,i,s,a);(J||_)&&(l={...l,...Nt(E.data,t.options)}),s._optimisticResults==="isRestoring"&&(l.fetchStatus="idle")}let{error:N,errorUpdatedAt:z,status:S}=l;m=l.data;let Z=!1;if(s.placeholderData!==void 0&&m===void 0&&S==="pending"){let O;h!=null&&h.isPlaceholderData&&s.placeholderData===(y==null?void 0:y.placeholderData)?(O=h.data,Z=!0):O=typeof s.placeholderData=="function"?s.placeholderData((Ct=r(this,K))==null?void 0:Ct.state.data,r(this,K)):s.placeholderData,O!==void 0&&(S="success",m=wt(h==null?void 0:h.data,O,s),q=!0)}if(s.select&&m!==void 0&&!Z)if(h&&m===(n==null?void 0:n.data)&&s.select===r(this,$))m=r(this,k);else try{c(this,$,s.select),m=s.select(m),m=wt(h==null?void 0:h.data,m,s),c(this,k,m),c(this,A,null)}catch(O){c(this,A,O)}r(this,A)&&(N=r(this,A),m=r(this,k),z=Date.now(),S="error");const rt=l.fetchStatus==="fetching",it=S==="pending",at=S==="error",vt=it&&rt,Rt=m!==void 0,w={status:S,fetchStatus:l.fetchStatus,isPending:it,isSuccess:S==="success",isError:at,isInitialLoading:vt,isLoading:vt,data:m,dataUpdatedAt:l.dataUpdatedAt,error:N,errorUpdatedAt:z,failureCount:l.fetchFailureCount,failureReason:l.fetchFailureReason,errorUpdateCount:l.errorUpdateCount,isFetched:l.dataUpdateCount>0||l.errorUpdateCount>0,isFetchedAfterMount:l.dataUpdateCount>g.dataUpdateCount||l.errorUpdateCount>g.errorUpdateCount,isFetching:rt,isRefetching:rt&&!it,isLoadingError:at&&!Rt,isPaused:l.fetchStatus==="paused",isPlaceholderData:q,isRefetchError:at&&Rt,isStale:gt(t,s),refetch:this.refetch,promise:r(this,D)};if(this.options.experimental_prefetchInRender){const O=G=>{w.status==="error"?G.reject(w.error):w.data!==void 0&&G.resolve(w.data)},J=()=>{const G=c(this,D,w.promise=Et());O(G)},_=r(this,D);switch(_.status){case"pending":t.queryHash===i.queryHash&&O(_);break;case"fulfilled":(w.status==="error"||w.data!==_.value)&&J();break;case"rejected":(w.status!=="error"||w.error!==_.reason)&&J();break}}return w}updateResult(){const t=r(this,p),s=this.createResult(r(this,u),this.options);if(c(this,P,r(this,u).state),c(this,j,this.options),r(this,P).data!==void 0&&c(this,K,r(this,u)),Y(s,t))return;c(this,p,s);const i=()=>{if(!t)return!0;const{notifyOnChangeProps:a}=this.options,h=typeof a=="function"?a():a;if(h==="all"||!h&&!r(this,B).size)return!0;const n=new Set(h??r(this,B));return this.options.throwOnError&&n.add("error"),Object.keys(r(this,p)).some(y=>{const b=y;return r(this,p)[b]!==t[b]&&n.has(b)})};f(this,o,jt).call(this,{listeners:i()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&f(this,o,lt).call(this)}},v=new WeakMap,u=new WeakMap,W=new WeakMap,p=new WeakMap,P=new WeakMap,j=new WeakMap,D=new WeakMap,A=new WeakMap,$=new WeakMap,k=new WeakMap,K=new WeakMap,F=new WeakMap,L=new WeakMap,M=new WeakMap,B=new WeakMap,o=new WeakSet,H=function(t){f(this,o,yt).call(this);let s=r(this,u).fetch(this.options,t);return t!=null&&t.throwOnError||(s=s.catch(tt)),s},ut=function(){f(this,o,ft).call(this);const t=V(this.options.staleTime,r(this,u));if(ht||r(this,p).isStale||!Ot(t))return;const i=Bt(r(this,p).dataUpdatedAt,t)+1;c(this,F,setTimeout(()=>{r(this,p).isStale||this.updateResult()},i))},ot=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(r(this,u)):this.options.refetchInterval)??!1},ct=function(t){f(this,o,dt).call(this),c(this,M,t),!(ht||T(this.options.enabled,r(this,u))===!1||!Ot(r(this,M))||r(this,M)===0)&&c(this,L,setInterval(()=>{(this.options.refetchIntervalInBackground||qt.isFocused())&&f(this,o,H).call(this)},r(this,M)))},lt=function(){f(this,o,ut).call(this),f(this,o,ct).call(this,f(this,o,ot).call(this))},ft=function(){r(this,F)&&(clearTimeout(r(this,F)),c(this,F,void 0))},dt=function(){r(this,L)&&(clearInterval(r(this,L)),c(this,L,void 0))},yt=function(){const t=r(this,v).getQueryCache().build(r(this,v),this.options);if(t===r(this,u))return;const s=r(this,u);c(this,u,t),c(this,W,t.state),this.hasListeners()&&(s==null||s.removeObserver(this),t.addObserver(this))},jt=function(t){st.batch(()=>{t.listeners&&this.listeners.forEach(s=>{s(r(this,p))}),r(this,v).getQueryCache().notify({query:r(this,u),type:"observerResultsUpdated"})})},Mt);function Vt(e,t){return T(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function It(e,t){return Vt(e,t)||e.state.data!==void 0&&bt(e,t,t.refetchOnMount)}function bt(e,t,s){if(T(t.enabled,e)!==!1&&V(t.staleTime,e)!=="static"){const i=typeof s=="function"?s(e):s;return i==="always"||i!==!1&&gt(e,t)}return!1}function Qt(e,t,s,i){return(e!==t||T(i.enabled,e)===!1)&&(!s.suspense||e.state.status!=="error")&&gt(e,s)}function gt(e,t){return T(t.enabled,e)!==!1&&e.isStaleByTime(V(t.staleTime,e))}function Wt(e,t){return!Y(e.getCurrentResult(),t)}var U,x,R,I,Q,X,mt,Ut,$t=(Ut=class extends xt{constructor(t,s){super();d(this,Q);d(this,U);d(this,x);d(this,R);d(this,I);c(this,U,t),this.setOptions(s),this.bindMethods(),f(this,Q,X).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){var i;const s=this.options;this.options=r(this,U).defaultMutationOptions(t),Y(this.options,s)||r(this,U).getMutationCache().notify({type:"observerOptionsUpdated",mutation:r(this,R),observer:this}),s!=null&&s.mutationKey&&this.options.mutationKey&&Tt(s.mutationKey)!==Tt(this.options.mutationKey)?this.reset():((i=r(this,R))==null?void 0:i.state.status)==="pending"&&r(this,R).setOptions(this.options)}onUnsubscribe(){var t;this.hasListeners()||(t=r(this,R))==null||t.removeObserver(this)}onMutationUpdate(t){f(this,Q,X).call(this),f(this,Q,mt).call(this,t)}getCurrentResult(){return r(this,x)}reset(){var t;(t=r(this,R))==null||t.removeObserver(this),c(this,R,void 0),f(this,Q,X).call(this),f(this,Q,mt).call(this)}mutate(t,s){var i;return c(this,I,s),(i=r(this,R))==null||i.removeObserver(this),c(this,R,r(this,U).getMutationCache().build(r(this,U),this.options)),r(this,R).addObserver(this),r(this,R).execute(t)}},U=new WeakMap,x=new WeakMap,R=new WeakMap,I=new WeakMap,Q=new WeakSet,X=function(){var s;const t=((s=r(this,R))==null?void 0:s.state)??zt();c(this,x,{...t,isPending:t.status==="pending",isSuccess:t.status==="success",isError:t.status==="error",isIdle:t.status==="idle",mutate:this.mutate,reset:this.reset})},mt=function(t){st.batch(()=>{var s,i,a,h,n,y,b,g;if(r(this,I)&&this.hasListeners()){const E=r(this,x).variables,l=r(this,x).context;(t==null?void 0:t.type)==="success"?((i=(s=r(this,I)).onSuccess)==null||i.call(s,t.data,E,l),(h=(a=r(this,I)).onSettled)==null||h.call(a,t.data,null,E,l)):(t==null?void 0:t.type)==="error"&&((y=(n=r(this,I)).onError)==null||y.call(n,t.error,E,l),(g=(b=r(this,I)).onSettled)==null||g.call(b,void 0,t.error,E,l))}this.listeners.forEach(E=>{E(r(this,x))})})},Ut),kt=C.createContext(!1),Zt=()=>C.useContext(kt);kt.Provider;function Jt(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var Gt=C.createContext(Jt()),Xt=()=>C.useContext(Gt),Yt=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},te=e=>{C.useEffect(()=>{e.clearReset()},[e])},ee=({result:e,errorResetBoundary:t,throwOnError:s,query:i,suspense:a})=>e.isError&&!t.isReset()&&!e.isFetching&&i&&(a&&e.data===void 0||Pt(s,[e.error,i])),se=e=>{if(e.suspense){const t=i=>i==="static"?i:Math.max(i??1e3,1e3),s=e.staleTime;e.staleTime=typeof s=="function"?(...i)=>t(s(...i)):t(s),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},re=(e,t)=>e.isLoading&&e.isFetching&&!t,ie=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,Dt=(e,t,s)=>t.fetchOptimistic(e).catch(()=>{s.clearReset()});function ae(e,t,s){var l,q,m,N,z;const i=Zt(),a=Xt(),h=pt(),n=h.defaultQueryOptions(e);(q=(l=h.getDefaultOptions().queries)==null?void 0:l._experimental_beforeQuery)==null||q.call(l,n),n._optimisticResults=i?"isRestoring":"optimistic",se(n),Yt(n,a),te(a);const y=!h.getQueryCache().get(n.queryHash),[b]=C.useState(()=>new t(h,n)),g=b.getOptimisticResult(n),E=!i&&e.subscribed!==!1;if(C.useSyncExternalStore(C.useCallback(S=>{const Z=E?b.subscribe(st.batchCalls(S)):tt;return b.updateResult(),Z},[b,E]),()=>b.getCurrentResult(),()=>b.getCurrentResult()),C.useEffect(()=>{b.setOptions(n)},[n,b]),ie(n,g))throw Dt(n,b,a);if(ee({result:g,errorResetBoundary:a,throwOnError:n.throwOnError,query:h.getQueryCache().get(n.queryHash),suspense:n.suspense}))throw g.error;if((N=(m=h.getDefaultOptions().queries)==null?void 0:m._experimental_afterQuery)==null||N.call(m,n,g),n.experimental_prefetchInRender&&!ht&&re(g,i)){const S=y?Dt(n,b,a):(z=h.getQueryCache().get(n.queryHash))==null?void 0:z.promise;S==null||S.catch(tt).finally(()=>{b.updateResult()})}return n.notifyOnChangeProps?g:b.trackResult(g)}function ne(e,t){return ae(e,Ht)}function he(e,t){const s=pt(),[i]=C.useState(()=>new $t(s,e));C.useEffect(()=>{i.setOptions(e)},[i,e]);const a=C.useSyncExternalStore(C.useCallback(n=>i.subscribe(st.batchCalls(n)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),h=C.useCallback((n,y)=>{i.mutate(n,y).catch(tt)},[i]);if(a.error&&Pt(i.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:h,mutateAsync:a.mutate}}const ge={USERS:{LIST:"/users",CREATE:"/users",DETAIL:e=>`/users/${e}`,UPDATE:e=>`/users/${e}`,DELETE:e=>`/users/${e}`}},ue=e=>e.replace(/_([a-zA-Z0-9])/g,(t,s)=>/[a-zA-Z]/.test(s)?s.toUpperCase():s),et=(e,t)=>{const s={};for(const[i,a]of Object.entries(t)){const h=oe(e,i);if(h!=null)if(Array.isArray(a)&&Array.isArray(h)){const n=a[0];s[i]=h.map(y=>typeof n=="object"&&n!==null?et(y,n):At(y,n))}else typeof a=="object"&&a!==null&&!Array.isArray(a)?s[i]=et(h,a):s[i]=At(h,a)}return s},oe=(e,t)=>{const s=Object.keys(e).find(i=>ue(i)===t);if(s)return e[s]},At=(e,t)=>t===Date?(e instanceof Date?e:new Date(e)).toISOString():t===Number?Number(e):t===Boolean?!!e:t===String?typeof e=="string"||e===null||e===void 0?e:typeof e=="object"?JSON.stringify(e):String(e):e;function ce(){const e=pt();return{call:s=>{s&&s.forEach(i=>{e.removeQueries({queryKey:Array.isArray(i)?i:[i]})})}}}function ve(e,t){e.data&&(t!=null&&t.bodyParamsStruct)?e.data=et(e.data,t.bodyParamsStruct):e.data={};const{t:s}=_t("common");return{query:ne({queryKey:(t==null?void 0:t.querykey)??[],queryFn:async()=>{try{const a=(await Lt(e)).data;if(typeof a!="object")throw new Error("Data response is not json object");return a}catch(a){const h=Ft(a,{t:s,message:t==null?void 0:t.message});if(h)throw new Error(h);return null}}})}}function Re(e,t){const{t:s}=_t("common"),i=Kt(),a=ce();return{mutation:he({mutationFn:(n,y)=>(n&&(t!=null&&t.bodyParamsStruct)?e.data=et(n,t.bodyParamsStruct):e.data={},y&&(e={...e,...y}),Lt(e)),onError:n=>{Ft(n,{t:s,message:t==null?void 0:t.message})},onSuccess(n){var y;(y=t==null?void 0:t.onSuccess)==null||y.call(t,n.data),a.call(t==null?void 0:t.refreshQuerykey),t!=null&&t.redirect&&i(t.redirect)}})}}export{ge as A,ve as a,ce as b,Re as u};
